<ПравилаОбмена>
	<ВерсияФормата РежимСовместимости="РежимСовместимостиСБСП20">2.01</ВерсияФормата>
	<Ид>47ef8958-88e7-46b3-8819-dbc89dea49a9    </Ид>
	<Наименование>_Розница 2.2 --&gt; БП 2.0.65 Нордмедиа</Наименование>
	<ДатаВремяСоздания>2019-11-22T18:57:03</ДатаВремяСоздания>
	<Источник ВерсияПлатформы="8.0" ВерсияКонфигурации="2.2.7.39" СинонимКонфигурации="Розница, редакция 2.2">Розница</Источник>
	<Приемник ВерсияПлатформы="8.0" ВерсияКонфигурации="2.0.66.76" СинонимКонфигурации="Бухгалтерия предприятия, редакция 2.0">БухгалтерияПредприятия</Приемник>
	<ПередВыгрузкойДанных>Если Не ЗначениеЗаполнено(Параметры.Организация) Тогда
	Сообщить("Обмен не возможен, не выбрана Организация, на закладке Параметры выгрузки!!!");
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкойДанных>
	<ПередЗагрузкойДанных>ТаблицаДокументов = Новый ТаблицаЗначений;
ТаблицаДокументов.Колонки.Добавить("Ссылка");
ТаблицаДокументов.Колонки.Добавить("Номер");
ТаблицаДокументов.Колонки.Добавить("Дата");
ТаблицаДокументов.Колонки.Добавить("МетаданныеИмя");
ТаблицаДокументов.Колонки.Добавить("Действие");

Параметры.Вставить("ТаблицаДокументов",ТаблицаДокументов);

Сообщить("Версия правил обмена данным: 1.005");


Параметры.Вставить("ВалютаРегламентированногоУчета", Константы.ВалютаРегламентированногоУчета.Получить());</ПередЗагрузкойДанных>
	<ПослеЗагрузкиДанных>ТекстСообщенияЗаписи = "";
ТекстСообщенияОшибки = "";
Сообщить("Начало проведения: "+ТекущаяДата());

Для каждого СтрокаТч Из Параметры.ТаблицаДокументов Цикл
    Если СтрокаТч.Действие = "Проведение" Тогда
        ДокОбъект = СтрокаТч.Ссылка.ПолучитьОбъект();
		Попытка 
			Если ДокОбъект.ПометкаУдаления 
				И ЗначениеЗаполнено(ДокОбъект.ССылка) Тогда 
				ДокОбъект.УстановитьПометкуУдаления(Ложь); 
			КонецЕсли;
        	ДокОбъект.Записать(РежимЗаписиДокумента.Проведение);
//			Сообщить("Проведен");
		Исключение    
			ДокОбъект.Записать();
//			Сообщить("Записан");
		КонецПопытки;
	ИначеЕсли СтрокаТч.Действие = "Удаление" Тогда
        ДокОбъект = СтрокаТч.Ссылка.ПолучитьОбъект();
		Если ЗначениеЗаполнено(ДокОбъект.ССылка) Тогда
			ДокОбъект.УстановитьПометкуУдаления(Истина); 
		КонецЕсли;	
	КонецЕсли;
КонецЦикла;

Сообщить("Завершение проведения: "+ТекущаяДата());</ПослеЗагрузкиДанных>
	<Параметры>
		<Параметр Имя="Магазин                                           " Наименование="Магазин" ИспользуетсяПриЗагрузке="false" УстанавливатьВДиалоге="true" ТипЗначения="СправочникСсылка.Магазины" ПередаватьПараметрПриВыгрузке="false"/>
		<Параметр Имя="Организация                                       " Наименование="Организация" ИспользуетсяПриЗагрузке="false" УстанавливатьВДиалоге="true" ТипЗначения="СправочникСсылка.Организации" ПередаватьПараметрПриВыгрузке="false"/>
	</Параметры>
	<Обработки/>
	<ПравилаКонвертацииОбъектов>
		<Группа>
			<Код>Документы</Код>
			<Наименование>Документы</Наименование>
			<Порядок>50</Порядок>
			<Правило>
				<Код>ПоступлениеТоваровУслуг</Код>
				<Наименование>Документ: Поступление товаров</Наименование>
				<Порядок>50</Порядок>
				<ПередВыгрузкой>Запросы.ПоступлениеТоваровПоСебестоимости.УстановитьПараметр("Ссылка", Источник.Ссылка);
Запросы.ПоступлениеТоваровПоСебестоимости.УстановитьПараметр("Магазин", Источник.Магазин);
Запросы.ПоступлениеТоваровПоСебестоимости.УстановитьПараметр("Период", КонецМесяца(Источник.Дата));

РезультатыЗапроса = Запросы.ПоступлениеТоваровПоСебестоимости.Выполнить();
ВходящиеДанные = Новый Структура;
ВходящиеДанные.Вставить("Товары", РезультатыЗапроса.Выгрузить());</ПередВыгрузкой>
				<ПередЗагрузкой>Выполнить(Алгоритмы.ПередЗагрузкойДокумента_РежимЗаписи);</ПередЗагрузкой>
				<ПослеЗагрузки>//Сообщить("НачалоПослеЗагрузки");
Объект.УчитыватьНДС = ложь;

Если ОбщегоНазначения.ЕстьРеквизитДокумента("ПодразделениеОрганизации", Объект.Метаданные()) Тогда
	Если ЗначениеЗаполнено(Объект.Склад) Тогда
		Склад = Объект.Склад;
		Подразделение =  Неопределено;
		Выполнить (Алгоритмы.ПолучитьПодразделение);
		Объект.ПодразделениеОрганизации = Подразделение;
	Иначе
		Объект.ПодразделениеОрганизации = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
	КонецЕсли;
КонецЕсли;

Выполнить(Алгоритмы.ОбработатьЗаписьДокументаПослеЗагрузки);
Выполнить(Алгоритмы.ЗаполнитьВалютуДокумента);

ЗаполнениеДокументовПоУмолчанию.ЗаполнитьСчетаПоУмолчанию(Объект);
Объект.ЗаполнитьСчетаУчетаВТабЧасти(Объект.Товары, "Товары", Истина, Истина);
Объект.ЗаполнитьСчетаУчетаВТабЧасти(Объект.Услуги, "Услуги", Истина, Истина);
Объект.СуммаДокумента = УчетНДС.ПолучитьСуммуДокументаСНДС(Объект);	
Объект.Ответственный = Справочники.Пользователи.НайтиПоНаименованию("Пользователь в рознице");
//Сообщить("НачалоУстановитьССылку");
Выполнить(Алгоритмы.ПослеЗагрузкиДокумента_УстановитьССылку);</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ПоступлениеТоваров</Источник>
				<Приемник>ДокументСсылка.ПоступлениеТоваровУслуг</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>19</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>18</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>Контрагент --&gt; Контрагент</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>Магазин --&gt; Склад</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Магазин" Вид="Реквизит" Тип="СправочникСсылка.Магазины"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>МагазиныСклады                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>ДатаВходящегоДокумента --&gt; ДатаВходящегоДокумента</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ДатаВходящегоДокумента" Вид="Реквизит" Тип="Дата"/>
						<Приемник Имя="ДатаВходящегоДокумента" Вид="Реквизит" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>НомерВходящегоДокумента --&gt; НомерВходящегоДокумента</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="НомерВходящегоДокумента" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НомерВходящегоДокумента" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>ПредъявленСчетФактура --&gt; ПредъявленСчетФактура</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="ПредъявленСчетФактура" Вид="Реквизит" Тип="Булево"/>
						<Приемник Имя="ПредъявленСчетФактура" Вид="Реквизит" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>УчитыватьНДС --&gt; УчитыватьНДС</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="УчитыватьНДС" Вид="Реквизит" Тип="Булево"/>
						<Приемник Имя="УчитыватьНДС" Вид="Реквизит" Тип="Булево"/>
						<ПередВыгрузкой>Значение = Ложь;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>1</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<ПередОбработкойВыгрузки>КоллекцияОбъектов = ВходящиеДанные.Товары;</ПередОбработкойВыгрузки>
						<Свойство>
							<Код>2</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>3</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>4</Код>
							<Наименование>СтавкаНДС --&gt; СтавкаНДС</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="СтавкаНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.СтавкиНДС"/>
							<Приемник Имя="СтавкаНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.СтавкиНДС"/>
							<КодПравилаКонвертации>СтавкиНДС                                         </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>5</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>СуммаНДС --&gt; СуммаНДС</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="СуммаНДС" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="СуммаНДС" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = 0;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
					<Свойство>
						<Код>20</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>ПометкаУдаления</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>21</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>750</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Проведен</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>22</Код>
						<Наименование>--&gt; УИД</Наименование>
						<Порядок>800</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>УИД</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Выполнить(Алгоритмы.ПередВыгрузкойПКС_ПолучитьУИД);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>23</Код>
						<Наименование>--&gt; СпособЗачетаАвансов</Наименование>
						<Порядок>850</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="СпособЗачетаАвансов" Вид="Реквизит" Тип="ПеречислениеСсылка.СпособыЗачетаАвансов"/>
						<ПередВыгрузкой>Значение = "Автоматически";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>24</Код>
						<Наименование>--&gt; ВидОперации</Наименование>
						<Порядок>900</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийПоступлениеТоваровУслуг"/>
						<ПередВыгрузкой>Значение = "ПокупкаКомиссия";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>25</Код>
						<Наименование>--&gt; ДоговорКонтрагента</Наименование>
						<Порядок>950</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ДоговорКонтрагента" Вид="Реквизит" Тип="СправочникСсылка.ДоговорыКонтрагентов"/>
						<КодПравилаКонвертации>ДоговорыКонтрагентов                              </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Новый Структура;
Значение.Вставить("Ссылка");
Значение.Вставить("ВидДоговора", "СПоставщиком");
Значение.Вставить("Владелец",    Источник.Контрагент);
Значение.Вставить("Организация", Источник.Организация);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>26</Код>
						<Наименование>--&gt; ТипЦен</Наименование>
						<Порядок>1000</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ТипЦен" Вид="Реквизит" Тип="СправочникСсылка.ТипыЦенНоменклатуры"/>
						<КодПравилаКонвертации>ТипыЦенНоменклатуры                               </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Магазин.ПравилоЦенообразования;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ОтчетОРозничныхПродажах</Код>
				<Наименование>Документ: Отчет о розничных продажах</Наименование>
				<Порядок>100</Порядок>
				<ПередВыгрузкой>Запросы.ОтчетОРозничныхПродажахПоСебестоимости.УстановитьПараметр("Ссылка", Источник.Ссылка);
Запросы.ОтчетОРозничныхПродажахПоСебестоимости.УстановитьПараметр("Магазин", Источник.Магазин);
Запросы.ОтчетОРозничныхПродажахПоСебестоимости.УстановитьПараметр("Период", КонецМесяца(Источник.Дата));

РезультатыЗапроса = Запросы.ОтчетОРозничныхПродажахПоСебестоимости.Выполнить();
ВходящиеДанные = Новый Структура;
ВходящиеДанные.Вставить("Товары", РезультатыЗапроса.Выгрузить());
ВходящиеДанные.Вставить("Субконто", lvОбщегоНазначенияСервер.ПолучитьДопРеквизитМагазина(Источник.Магазин, "Отчет продаж Номенклатурная группа"));</ПередВыгрузкой>
				<ПередЗагрузкой>Выполнить(Алгоритмы.ПередЗагрузкойДокумента_РежимЗаписи);</ПередЗагрузкой>
				<ПослеЗагрузки>Если ОбщегоНазначения.ЕстьРеквизитДокумента("ПодразделениеОрганизации", Объект.Метаданные()) Тогда
	Если ЗначениеЗаполнено(Объект.Склад) Тогда
		Склад = Объект.Склад;
		Подразделение =  Неопределено;
		Выполнить (Алгоритмы.ПолучитьПодразделение);
		Объект.ПодразделениеОрганизации = Подразделение;
	Иначе
		Объект.ПодразделениеОрганизации = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
	КонецЕсли;
КонецЕсли;

Объект.ВалютаДокумента  = Параметры.ВалютаРегламентированногоУчета;
СтруктураКурсаДокумента = МодульВалютногоУчета.ПолучитьКурсВалюты(Объект.ВалютаДокумента, Объект.Дата);
Объект.КурсДокумента      = СтруктураКурсаДокумента.Курс;
Объект.КратностьДокумента = СтруктураКурсаДокумента.Кратность;
Объект.Ответственный = Справочники.Пользователи.НайтиПоНаименованию("Пользователь в рознице");
Объект.УчитыватьНДС = ложь;

Выполнить(Алгоритмы.ОбработатьЗаписьДокументаПослеЗагрузки);
ЗаполнениеДокументовПоУмолчанию.ЗаполнитьСчетаПоУмолчанию(Объект);

Объект.СуммаДокумента = УчетНДС.ПолучитьСуммуДокументаСНДС(Объект, "Товары") + УчетНДС.ПолучитьСуммуДокументаСНДС(Объект, "АгентскиеУслуги");
Если Объект.Оплата.Количество() &gt; 0 Тогда
	Для Каждого ТекСтрока Из Объект.Оплата Цикл
		ВидОплаты = ТекСтрока.ВидОплаты;   			
		Если ВидОплаты.ТипОплаты = Перечисления.ТипыОплат.ПлатежнаяКарта Тогда			
			Если ЗначениеЗаполнено(ВидОплаты.Контрагент) Тогда
				ТекСтрока.Контрагент         = ВидОплаты.Контрагент;
				ТекСтрока.ДоговорКонтрагента = ВидОплаты.ДоговорКонтрагента;
				ТекСтрока.СчетУчетаРасчетов  = ВидОплаты.СчетУчетаРасчетов;
			КонецЕсли;
		КонецЕсли;			
	КонецЦикла;			
КонецЕсли; 	

Субконто = ПараметрыОбъекта["Субконто"];
Если Объект.Товары.Количество() &gt; 0 Тогда
	Для Каждого ТекСтрока Из Объект.Товары Цикл
		ТекСтрока.Субконто = Справочники.НоменклатурныеГруппы.НайтиПоНаименованию(Субконто);
    КонецЦикла;
КонецЕсли;


Объект.СЧетКасса = ПланыСчетов.Хозрасчетный.КассаОрганизации;
Выполнить(Алгоритмы.ПослеЗагрузкиДокумента_УстановитьССылку);</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ОтчетОРозничныхПродажах</Источник>
				<Приемник>ДокументСсылка.ОтчетОРозничныхПродажах</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>12</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>13</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>УчитыватьНДС --&gt; УчитыватьНДС</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="УчитыватьНДС" Вид="Реквизит" Тип="Булево"/>
						<Приемник Имя="УчитыватьНДС" Вид="Реквизит" Тип="Булево"/>
						<ПередВыгрузкой>Значение = Ложь;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>ПометкаУдаления</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Проведен</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>Магазин --&gt; Склад</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Магазин" Вид="Реквизит" Тип="СправочникСсылка.Магазины"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>МагазиныСклады                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>22</Код>
						<Наименование>--&gt; ВидОперации</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийОтчетОРозничныхПродажах"/>
						<ПередВыгрузкой>Значение = "ОтчетККМОПродажах";
//Значение = "ОтчетНТТОПродажах";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>20</Код>
						<Наименование>--&gt; ТипЦен</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ТипЦен" Вид="Реквизит" Тип="СправочникСсылка.ТипыЦенНоменклатуры"/>
						<КодПравилаКонвертации>ТипыЦенНоменклатуры                               </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Магазин.ПравилоЦенообразования;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>23</Код>
						<Наименование>--&gt; СчетКасса</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="СчетКасса" Вид="Реквизит" Тип="ПланСчетовСсылка.Хозрасчетный"/>
						<ПередВыгрузкой>Значение = "КассаОрганизации";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>25</Код>
						<Наименование>--&gt; УИД</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>УИД</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Выполнить(Алгоритмы.ПередВыгрузкойПКС_ПолучитьУИД);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>26</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
					</Свойство>
					<Свойство>
						<Код>28</Код>
						<Наименование>--&gt; Субконто</Наименование>
						<Порядок>750</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Субконто</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Значение = ВходящиеДанные.Субконто;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>1</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>800</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<ПередОбработкойВыгрузки>КоллекцияОбъектов = ВходящиеДанные.Товары</ПередОбработкойВыгрузки>
						<Свойство>
							<Код>2</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>3</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>4</Код>
							<Наименование>СтавкаНДС --&gt; СтавкаНДС</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="СтавкаНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.СтавкиНДС"/>
							<Приемник Имя="СтавкаНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.СтавкиНДС"/>
							<КодПравилаКонвертации>СтавкиНДС                                         </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>5</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>СуммаНДС --&gt; СуммаНДС</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="СуммаНДС" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="СуммаНДС" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = 0;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>24</Код>
							<Наименование>--&gt; Себестоимость</Наименование>
							<Порядок>350</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Себестоимость" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Себестоимость;
//Сообщить(ОбъектКоллекции.Себестоимость);</ПередВыгрузкой>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ПриходныйКассовыйОрдер</Код>
				<Наименование>Документ: Приходный кассовый ордер</Наименование>
				<Порядок>150</Порядок>
				<ПередЗагрузкой>Выполнить(Алгоритмы.ПередЗагрузкойДокумента_РежимЗаписи);</ПередЗагрузкой>
				<ПослеЗагрузки>Выполнить(Алгоритмы.ОбработатьЗаписьДокументаПослеЗагрузки);
Объект.ВалютаДокумента  = Параметры.ВалютаРегламентированногоУчета;
ЗаполнениеДокументовПоУмолчанию.ЗаполнитьСчетаПоУмолчанию(Объект);

Объект.СчетУчетаРасчетовСКонтрагентом = ПланыСчетов.Хозрасчетный.ВыручкаЕНВД;

Объект.Ответственный = Справочники.Пользователи.НайтиПоНаименованию("Пользователь в рознице");

СубконтоКт1 = ПараметрыОбъекта["СубконтоКт1"];
Объект.СубконтоКт1 = Справочники.НоменклатурныеГруппы.НайтиПоНаименованию(СубконтоКт1);
Выполнить(Алгоритмы.ПослеЗагрузкиДокумента_УстановитьССылку);</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ПриходныйКассовыйОрдер</Источник>
				<Приемник>ДокументСсылка.ПриходныйКассовыйОрдер</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>19</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>18</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>22</Код>
						<Наименование>--&gt; ВидОперации</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийПКО"/>
						<ПередВыгрузкой>Значение = "ПрочийПриход";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>ДокументОснование --&gt; ДокументОснование</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ДокументОснование" Вид="Реквизит"/>
						<Приемник Имя="ДокументОснование" Вид="Реквизит"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>НомерЧекаККМ --&gt; НомерЧекаККМ</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="НомерЧекаККМ" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="НомерЧекаККМ" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>Основание --&gt; Основание</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Основание" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Основание" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Торговая выручка";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>Приложение --&gt; Приложение</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Приложение" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Приложение" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>ПринятоОт --&gt; ПринятоОт</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="ПринятоОт" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ПринятоОт" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = lvОбщегоНазначенияСервер.ПолучитьДопРеквизитМагазина(Источник.КассаККМ.Магазин, "ПКО Принято от");</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>23</Код>
						<Наименование>--&gt; СтатьяДвиженияДенежныхСредств</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<ПередВыгрузкой>Значение = lvОбщегоНазначенияСервер.ПолучитьДопРеквизитМагазина(Источник.КассаККМ.Магазин, "Статья ДДС");</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>25</Код>
						<Наименование>--&gt; СубконтоКт1</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>СубконтоКт1</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Значение =  lvОбщегоНазначенияСервер.ПолучитьДопРеквизитМагазина(Источник.КассаККМ.Магазин, "ПКО Номенклатурная группа");</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>20</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>ПометкаУдаления</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>21</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>750</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Проведен</ИмяПараметраДляПередачи>
					</Свойство>
					<Группа>
						<Код>1</Код>
						<Наименование>РасшифровкаПлатежа --&gt; РасшифровкаПлатежа</Наименование>
						<Порядок>800</Порядок>
						<Источник Имя="РасшифровкаПлатежа" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="РасшифровкаПлатежа" Вид="ТабличнаяЧасть"/>
						<ПередОбработкойВыгрузки>КоллекцияОбъектов = Новый ТаблицаЗначений;
КоллекцияОбъектов.Колонки.Добавить("СтатьяДвиженияДенежныхСредств");
КоллекцияОбъектов.Колонки.Добавить("СуммаПлатежа");
КоллекцияОбъектов.Колонки.Добавить("СпособПогашенияЗадолженности");
КоллекцияОбъектов.Колонки.Добавить("КратностьВзаиморасчетов");
КоллекцияОбъектов.Колонки.Добавить("КурсВзаиморасчетов");
КоллекцияОбъектов.Колонки.Добавить("СуммаВзаиморасчетов");
КоллекцияОбъектов.Добавить();</ПередОбработкойВыгрузки>
						<Свойство>
							<Код>2</Код>
							<Наименование>--&gt; СтатьяДвиженияДенежныхСредств</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
							<КодПравилаКонвертации>СтатьиДвиженияДенежныхСредств_ПКО                 </КодПравилаКонвертации>
							<ПередВыгрузкой>Значение = Справочники.СтатьиДвиженияДенежныхСредств.ПоступлениеДенежныхСредствИзКассыККМ;
ИсходящиеДанные = Новый Структура;
ИсходящиеДанные.Вставить("Магазин", Источник.КассаККМ.Магазин);</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>3</Код>
							<Наименование>--&gt; КратностьВзаиморасчетов</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="КратностьВзаиморасчетов" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = 1;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>4</Код>
							<Наименование>--&gt; КурсВзаиморасчетов</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="КурсВзаиморасчетов" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = 1;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>5</Код>
							<Наименование>--&gt; СпособПогашенияЗадолженности</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="СпособПогашенияЗадолженности" Вид="Реквизит" Тип="ПеречислениеСсылка.СпособыПогашенияЗадолженности"/>
							<ПередВыгрузкой>Значение = "Автоматически";</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>--&gt; СуммаВзаиморасчетов</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="СуммаВзаиморасчетов" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = Источник.СуммаДокумента;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>--&gt; СуммаПлатежа</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="СуммаПлатежа" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = Источник.СуммаДокумента;</ПередВыгрузкой>
						</Свойство>
					</Группа>
					<Свойство>
						<Код>24</Код>
						<Наименование>--&gt; УИД</Наименование>
						<Порядок>850</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>УИД</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Выполнить(Алгоритмы.ПередВыгрузкойПКС_ПолучитьУИД);</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ОприходованиеТоваров</Код>
				<Наименование>Документ: Оприходование товаров</Наименование>
				<Порядок>200</Порядок>
				<ПередВыгрузкой>Запросы.ОприходованиеТоваров.УстановитьПараметр("Ссылка", Источник.Ссылка);
Запросы.ОприходованиеТоваров.УстановитьПараметр("Магазин", Источник.Магазин);
Запросы.ОприходованиеТоваров.УстановитьПараметр("Период", КонецМесяца(Источник.Дата));

РезультатыЗапроса = Запросы.ОприходованиеТоваров.Выполнить();
ВходящиеДанные = Новый Структура;
ВходящиеДанные.Вставить("Товары", РезультатыЗапроса.Выгрузить());</ПередВыгрузкой>
				<ПередЗагрузкой>Выполнить(Алгоритмы.ПередЗагрузкойДокумента_РежимЗаписи);</ПередЗагрузкой>
				<ПослеЗагрузки>Если ОбщегоНазначения.ЕстьРеквизитДокумента("ПодразделениеОрганизации", Объект.Метаданные()) Тогда
	Если ЗначениеЗаполнено(Объект.Склад) Тогда
		Склад = Объект.Склад;
		Подразделение =  Неопределено;
		Выполнить (Алгоритмы.ПолучитьПодразделение);
		Объект.ПодразделениеОрганизации = Подразделение;
	Иначе
		Объект.ПодразделениеОрганизации = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
	КонецЕсли;
КонецЕсли;

Выполнить(Алгоритмы.ОбработатьЗаписьДокументаПослеЗагрузки);
Объект.СуммаДокумента = Объект.Товары.Итог("Сумма");
ЗаполнениеДокументовПоУмолчанию.ЗаполнитьСчетаПоУмолчанию(Объект);

Объект.Ответственный = Справочники.Пользователи.НайтиПоНаименованию("Пользователь в рознице");
Выполнить(Алгоритмы.ПослеЗагрузкиДокумента_УстановитьССылку);</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ОприходованиеТоваров</Источник>
				<Приемник>ДокументСсылка.ОприходованиеТоваров</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>14</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование>Магазин --&gt; Склад</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Магазин" Вид="Реквизит" Тип="СправочникСсылка.Магазины"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>МагазиныСклады                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>ПометкаУдаления</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Проведен</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>19</Код>
						<Наименование>--&gt; ТипЦен</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ТипЦен" Вид="Реквизит" Тип="СправочникСсылка.ТипыЦенНоменклатуры"/>
						<КодПравилаКонвертации>ТипыЦенНоменклатуры                               </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Магазин.ПравилоЦенообразования;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>20</Код>
						<Наименование>--&gt; СтатьяПрочихДоходовРасходов</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="СтатьяПрочихДоходовРасходов" Вид="Реквизит" Тип="СправочникСсылка.ПрочиеДоходыИРасходы"/>
						<ПередВыгрузкой>Значение = "РазницыСтоимостиВозвратаИФактическойСтоимостиТоваров";</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>1</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<ПередОбработкойВыгрузки>КоллекцияОбъектов = ВходящиеДанные.Товары;</ПередОбработкойВыгрузки>
						<Свойство>
							<Код>2</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>3</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>4</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>5</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>--&gt; ЕдиницаИзмерения</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>--&gt; Коэффициент</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = 1;</ПередВыгрузкой>
						</Свойство>
					</Группа>
					<Свойство>
						<Код>21</Код>
						<Наименование>--&gt; УИД</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>УИД</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Выполнить(Алгоритмы.ПередВыгрузкойПКС_ПолучитьУИД);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>22</Код>
						<Наименование>--&gt; Основание</Наименование>
						<Порядок>750</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Основание" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Если ЗначениеЗаполнено(Источник.ДокументОснование) Тогда
	Значение = "Приказ на инвентаризацию № "+ СокрЛП(Источник.ДокументОснование.Номер) + " от " + Формат(Источник.ДокументОснование.Дата,"ДФ=dd.MM.yyyy");
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СписаниеТоваров</Код>
				<Наименование>Документ: Списание товаров</Наименование>
				<Порядок>250</Порядок>
				<ПередВыгрузкой>Запросы.СписаниеТоваров.УстановитьПараметр("Ссылка", Источник.Ссылка);
Запросы.СписаниеТоваров.УстановитьПараметр("Магазин", Источник.Магазин);
Запросы.СписаниеТоваров.УстановитьПараметр("Период", КонецМесяца(Источник.Дата));

РезультатыЗапроса = Запросы.СписаниеТоваров.Выполнить();
ВходящиеДанные = Новый Структура;
ВходящиеДанные.Вставить("Товары", РезультатыЗапроса.Выгрузить());</ПередВыгрузкой>
				<ПередЗагрузкой>Выполнить(Алгоритмы.ПередЗагрузкойДокумента_РежимЗаписи);</ПередЗагрузкой>
				<ПослеЗагрузки>Если ОбщегоНазначения.ЕстьРеквизитДокумента("ПодразделениеОрганизации", Объект.Метаданные()) Тогда
	Если ЗначениеЗаполнено(Объект.Склад) Тогда
		Склад = Объект.Склад;
		Подразделение =  Неопределено;
		Выполнить (Алгоритмы.ПолучитьПодразделение);
		Объект.ПодразделениеОрганизации = Подразделение;
	Иначе
		Объект.ПодразделениеОрганизации = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
	КонецЕсли;
КонецЕсли;

Выполнить(Алгоритмы.ОбработатьЗаписьДокументаПослеЗагрузки);
Объект.СуммаДокумента = Объект.Товары.Итог("Сумма");
Для каждого СтрокаТЧ Из Объект.Товары Цикл
	СтрокаТЧ.ОтражениеВУСН = Перечисления.ОтражениеВУСН.НеПринимаются;
КонецЦикла;
ЗаполнениеДокументовПоУмолчанию.ЗаполнитьСчетаПоУмолчанию(Объект);

Объект.Ответственный = Справочники.Пользователи.НайтиПоНаименованию("Пользователь в рознице");
Выполнить(Алгоритмы.ПослеЗагрузкиДокумента_УстановитьССылку);</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.СписаниеТоваров</Источник>
				<Приемник>ДокументСсылка.СписаниеТоваров</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>13</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>14</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>Магазин --&gt; Склад</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Магазин" Вид="Реквизит" Тип="СправочникСсылка.Магазины"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>МагазиныСклады                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>ПометкаУдаления</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Проведен</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>--&gt; ВидОперации</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийСписаниеТоваров"/>
						<ПередВыгрузкой>Значение = "ТоварыПродукция";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>18</Код>
						<Наименование>--&gt; УИД</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>УИД</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Выполнить(Алгоритмы.ПередВыгрузкойПКС_ПолучитьУИД);</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>1</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<ПередОбработкойВыгрузки>КоллекцияОбъектов = ВходящиеДанные.Товары;</ПередОбработкойВыгрузки>
						<Свойство>
							<Код>2</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>3</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>4</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>5</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>--&gt; ЕдиницаИзмерения</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
						</Свойство>
						<Свойство>
							<Код>19</Код>
							<Наименование>--&gt; Себестоимость</Наименование>
							<Порядок>350</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Себестоимость" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
					<Свойство>
						<Код>20</Код>
						<Наименование>--&gt; Основание</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Основание" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Если ЗначениеЗаполнено(Источник.ДокументОснование) Тогда
	Значение = "Приказ на инвентаризацию № "+ СокрЛП(Источник.ДокументОснование.Номер) + " от " + Формат(Источник.ДокументОснование.Дата,"ДФ=dd.MM.yyyy");
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ОперацияБух</Код>
				<Наименование>:</Наименование>
				<Порядок>300</Порядок>
				<ПередВыгрузкой>КлючВыгружаемыхДанных = "КлючВыгружаемыхДанных" + Источник.Организация + Источник.Магазин + Источник.Номер + Источник.Дата;
ВходящиеДанные = Новый Структура;
ВходящиеДанные.Вставить("СубконтоДт1", lvОбщегоНазначенияСервер.ПолучитьДопРеквизитМагазина(Источник.Магазин, "Банк Плательщик"));
ВходящиеДанные.Вставить("СубконтоДт2", lvОбщегоНазначенияСервер.ПолучитьДопРеквизитМагазина(Источник.Магазин, "Банк Договор (плательщика)"));	
ВходящиеДанные.Вставить("СубконтоКт1", lvОбщегоНазначенияСервер.ПолучитьДопРеквизитМагазина(Источник.Магазин, "Банк Номенклатурная группа"));
ВходящиеДанные.Вставить("Содержание", "Оплата банковской картой: " + Источник.Магазин);</ПередВыгрузкой>
				<ПослеЗагрузки>СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("57.03");
СчетКт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("90.01.2");
Объект.Ответственный = Справочники.Пользователи.НайтиПоНаименованию("Пользователь в рознице");

Если ОбъектМодифицирован ИЛИ НЕ ОбъектНайден Тогда
	Объект.Записать();
	ОбъектМодифицирован = Ложь;
КонецЕсли;	


РХ = РегистрыБухгалтерии.Хозрасчетный.СоздатьНаборЗаписей();
РХ.Отбор.Регистратор.Значение = Объект.Ссылка;         
РХ.Прочитать();
РХ.Очистить();

Если ПараметрыОбъекта["Проведен"] Тогда
	новЗапись = РХ.Добавить();
	новЗапись.СчетКт = СчетКт;
	новЗапись.СчетДт = СчетДт;
	Если ЗначениеЗаполнено(ПараметрыОбъекта["СубконтоДт1"]) Тогда
		СубконтоДт1 = Справочники.Контрагенты.НайтиПоНаименованию(ПараметрыОбъекта["СубконтоДт1"]);
		БухгалтерскийУчет.УстановитьСубконто(новЗапись.СчетДт,новЗапись.СубконтоДт ,"Контрагенты",СубконтоДт1);
	КонецЕсли;

	Если ЗначениеЗаполнено(ПараметрыОбъекта["СубконтоДт1"]) Тогда
		СубконтоДт2 = Справочники.ДоговорыКонтрагентов.НайтиПоНаименованию(ПараметрыОбъекта["СубконтоДт2"],,,СубконтоДт1);
		БухгалтерскийУчет.УстановитьСубконто(новЗапись.СчетДт,новЗапись.СубконтоДт ,"Договоры",СубконтоДт2);
	КонецЕсли;

	Если ЗначениеЗаполнено(ПараметрыОбъекта["СубконтоКт1"]) Тогда
		СубконтоКт1 = Справочники.НоменклатурныеГруппы.НайтиПоНаименованию(ПараметрыОбъекта["СубконтоКт1"]);
		БухгалтерскийУчет.УстановитьСубконто(новЗапись.СчетКт,новЗапись.СубконтоКт ,"НоменклатурныеГруппы",СубконтоКт1);
	КонецЕсли;
	
	новЗапись.Период = Объект.Дата;
	новЗапись.Регистратор = Объект.Ссылка;
	новЗапись.Организация = Объект.Организация;
	новЗапись.Содержание = "Оплата банковской картой";
	новЗапись.Сумма = Объект.СуммаОперации;
	новЗапись.СуммаНУДт = новЗапись.Сумма;
	новЗапись.СуммаНУКт = новЗапись.Сумма;

КонецЕсли;
РХ.Записать();</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ОтчетОРозничныхПродажах</Источник>
				<Приемник>ДокументСсылка.ОперацияБух</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>7</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>--&gt; СуммаОперации</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="СуммаОперации" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>ПометкаУдаления</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Проведен</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование>--&gt; СпособЗаполнения</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="СпособЗаполнения" Вид="Реквизит"/>
						<ПередВыгрузкой>Значение = "Вручную";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>--&gt; СубконтоДт1</Наименование>
						<Порядок>550</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>СубконтоДт1</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>--&gt; СубконтоДт2</Наименование>
						<Порядок>600</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>СубконтоДт2</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>--&gt; СубконтоКт1</Наименование>
						<Порядок>650</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>СубконтоКт1</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>--&gt; Содержание</Наименование>
						<Порядок>700</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Содержание" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>750</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "#"+Источник.Номер;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ПеремещениеТоваров</Код>
				<Наименование>Документ: Перемещение товаров</Наименование>
				<Порядок>350</Порядок>
				<ПередВыгрузкой>Запросы.ПеремещениеТоваров.УстановитьПараметр("Ссылка", Источник.Ссылка);
Запросы.ПеремещениеТоваров.УстановитьПараметр("Магазин", Источник.МагазинОтправитель);
Запросы.ПеремещениеТоваров.УстановитьПараметр("Период", КонецМесяца(Источник.Дата));

РезультатыЗапроса = Запросы.ПеремещениеТоваров.Выполнить();
ВходящиеДанные = Новый Структура;
ВходящиеДанные.Вставить("Товары", РезультатыЗапроса.Выгрузить());</ПередВыгрузкой>
				<ПередЗагрузкой>Выполнить(Алгоритмы.ПередЗагрузкойДокумента_РежимЗаписи);</ПередЗагрузкой>
				<ПослеЗагрузки>Выполнить(Алгоритмы.ОбработатьЗаписьДокументаПослеЗагрузки);
ЗаполнениеДокументовПоУмолчанию.ЗаполнитьСчетаПоУмолчанию(Объект);

Объект.Ответственный = Справочники.Пользователи.НайтиПоНаименованию("Пользователь в рознице");
Выполнить(Алгоритмы.ПослеЗагрузкиДокумента_УстановитьССылку);</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ПеремещениеТоваров</Источник>
				<Приемник>ДокументСсылка.ПеремещениеТоваров</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>11</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>12</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>МагазинОтправитель --&gt; СкладОтправитель</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="МагазинОтправитель" Вид="Реквизит" Тип="СправочникСсылка.Магазины"/>
						<Приемник Имя="СкладОтправитель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>МагазиныСклады                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>МагазинПолучатель --&gt; СкладПолучатель</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="МагазинПолучатель" Вид="Реквизит" Тип="СправочникСсылка.Магазины"/>
						<Приемник Имя="СкладПолучатель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>МагазиныСклады                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство Отключить="true">
						<Код>16</Код>
						<Наименование>СкладОтправитель --&gt; СкладОтправитель</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="СкладОтправитель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="СкладОтправитель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Отключить="true">
						<Код>17</Код>
						<Наименование>СкладПолучатель --&gt; СкладПолучатель</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="СкладПолучатель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="СкладПолучатель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>--&gt; УИД</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>УИД</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Выполнить(Алгоритмы.ПередВыгрузкойПКС_ПолучитьУИД);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>ПометкаУдаления</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Проведен</ИмяПараметраДляПередачи>
					</Свойство>
					<Группа>
						<Код>1</Код>
						<Наименование>--&gt; Товары</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<ПередОбработкойВыгрузки>КоллекцияОбъектов = ВходящиеДанные.Товары;</ПередОбработкойВыгрузки>
						<Свойство>
							<Код>2</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>3</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>4</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>5</Код>
							<Наименование>Сумма --&gt; Себестоимость</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Себестоимость" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ВозвратТоваровПоставщику</Код>
				<Наименование>Документ: Возврат товаров поставщику</Наименование>
				<Порядок>400</Порядок>
				<ПередЗагрузкой>Выполнить(Алгоритмы.ПередЗагрузкойДокумента_РежимЗаписи);</ПередЗагрузкой>
				<ПослеЗагрузки>
мСписокВидовДоговоров = Новый СписокЗначений;
мСписокВидовДоговоров.Добавить(Перечисления.ВидыДоговоровКонтрагентов.СПоставщиком);

ЗаполнениеДокументов.ПриИзмененииЗначенияКонтрагента(Объект, мСписокВидовДоговоров);

Если ЗначениеЗАполнено(Объект.ДоговорКонтрагента) Тогда
	Объект.ВалютаДокумента    = Объект.ДоговорКонтрагента.ВалютаВзаиморасчетов;
	СтруктураКурсаДокумента = МодульВалютногоУчета.ПолучитьКурсВалюты(Объект.ДоговорКонтрагента.ВалютаВзаиморасчетов, Объект.Дата);
	Объект.КурсВзаиморасчетов      = СтруктураКурсаДокумента.Курс;
	Объект.КратностьВзаиморасчетов = СтруктураКурсаДокумента.Кратность;
КонецЕсли;	

Объект.УчитыватьНДС = ложь;

ЗаполнениеДокументовПоУмолчанию.ЗаполнитьСчетаПоУмолчанию(Объект);
Объект.ЗаполнитьСчетаУчетаРасчетов();
Объект.ЗаполнитьСчетаУчетаВТабЧасти(Объект.Товары, "Товары", Истина);

Если ОбщегоНазначения.ЕстьРеквизитДокумента("ПодразделениеОрганизации", Объект.Метаданные()) Тогда
	Если ЗначениеЗаполнено(Объект.Склад) Тогда
		Склад = Объект.Склад;
		Подразделение =  Неопределено;
		Выполнить (Алгоритмы.ПолучитьПодразделение);
		Объект.ПодразделениеОрганизации = Подразделение;
	Иначе
		Объект.ПодразделениеОрганизации = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
	КонецЕсли;
КонецЕсли;

Выполнить(Алгоритмы.ОбработатьЗаписьДокументаПослеЗагрузки);
Объект.СуммаДокумента = Объект.Товары.Итог("Сумма");
//Для каждого СтрокаТЧ Из Объект.Товары Цикл
//	СтрокаТЧ.ОтражениеВУСН = Перечисления.ОтражениеВУСН.НеПринимаются;
//КонецЦикла;

Объект.Ответственный = Справочники.Пользователи.НайтиПоНаименованию("Пользователь в рознице");
Выполнить(Алгоритмы.ПослеЗагрузкиДокумента_УстановитьССылку);</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ВозвратТоваровПоставщику</Источник>
				<Приемник>ДокументСсылка.ВозвратТоваровПоставщику</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>15</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>16</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Контрагент --&gt; Контрагент</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование>Магазин --&gt; Склад</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Магазин" Вид="Реквизит" Тип="СправочникСсылка.Магазины"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>МагазиныСклады                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>УчитыватьНДС --&gt; УчитыватьНДС</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="УчитыватьНДС" Вид="Реквизит" Тип="Булево"/>
						<Приемник Имя="УчитыватьНДС" Вид="Реквизит" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>ПометкаУдаления</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>18</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>Проведен</ИмяПараметраДляПередачи>
					</Свойство>
					<Свойство>
						<Код>19</Код>
						<Наименование>--&gt; УИД</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="" Вид=""/>
						<ИмяПараметраДляПередачи>УИД</ИмяПараметраДляПередачи>
						<ПередВыгрузкой>Выполнить(Алгоритмы.ПередВыгрузкойПКС_ПолучитьУИД);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>21</Код>
						<Наименование>--&gt; ВидОперации</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийВозвратТоваровПоставщику"/>
						<ПередВыгрузкой>Значение = "ПокупкаКомиссия";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>22</Код>
						<Наименование>--&gt; ТипЦен</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ТипЦен" Вид="Реквизит" Тип="СправочникСсылка.ТипыЦенНоменклатуры"/>
						<КодПравилаКонвертации>ТипыЦенНоменклатуры                               </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Магазин.ПравилоЦенообразования;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>1</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>750</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>2</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>3</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
						</Свойство>
						<Свойство>
							<Код>4</Код>
							<Наименование>СтавкаНДС --&gt; СтавкаНДС</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="СтавкаНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.СтавкиНДС"/>
							<Приемник Имя="СтавкаНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.СтавкиНДС"/>
						</Свойство>
						<Свойство>
							<Код>5</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>СуммаНДС --&gt; СуммаНДС</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="СуммаНДС" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="СуммаНДС" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>20</Код>
							<Наименование>НомерГТД --&gt; НомерГТД</Наименование>
							<Порядок>350</Порядок>
							<Источник Имя="НомерГТД" Вид="Реквизит" Тип="СправочникСсылка.НомераГТД"/>
							<Приемник Имя="НомерГТД" Вид="Реквизит" Тип="СправочникСсылка.НомераГТД"/>
						</Свойство>
						<Свойство>
							<Код>23</Код>
							<Наименование>Сумма --&gt; Себестоимость</Наименование>
							<Порядок>400</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Себестоимость" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>24</Код>
							<Наименование>Сумма --&gt; СуммаВРознице</Наименование>
							<Порядок>450</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="СуммаВРознице" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
		<Группа>
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>100</Порядок>
			<Правило>
				<Код>Организации</Код>
				<Наименование>Справочник: Организации</Наименование>
				<Порядок>50</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<Источник>СправочникСсылка.Организации</Источник>
				<Приемник>СправочникСсылка.Организации</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>ИНН --&gt; ИНН</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Если Источник.ОбособленноеПодразделение Тогда
	Значение = Источник.ГоловнаяОрганизация.ИНН;
Иначе
	Значение = Источник.ИНН;	
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>КПП --&gt; КПП</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="КПП" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="КПП" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Если Источник.ОбособленноеПодразделение Тогда
	Значение = Источник.ГоловнаяОрганизация.КПП;
Иначе
	Значение = Источник.КПП;
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>НаименованиеПолное --&gt; НаименованиеПолное</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Контрагенты</Код>
				<Наименование>Справочник: Контрагенты</Наименование>
				<Порядок>100</Порядок>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>СправочникСсылка.Контрагенты</Источник>
				<Приемник>СправочникСсылка.Контрагенты</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>8</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>12</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>1</Код>
						<Наименование>ДокументУдостоверяющийЛичность --&gt; ДокументУдостоверяющийЛичность</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ДокументУдостоверяющийЛичность" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ДокументУдостоверяющийЛичность" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>ИНН --&gt; ИНН</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>КодПоОКПО --&gt; КодПоОКПО</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="КодПоОКПО" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="КодПоОКПО" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>КПП --&gt; КПП</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="КПП" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="КПП" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>НаименованиеПолное --&gt; НаименованиеПолное</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>ЮрФизЛицо --&gt; ЮрФизЛицо</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="ЮрФизЛицо" Вид="Реквизит" Тип="ПеречислениеСсылка.ЮрФизЛицо"/>
						<Приемник Имя="ЮрФизЛицо" Вид="Реквизит" Тип="ПеречислениеСсылка.ЮрФизЛицо"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>МагазиныСклады</Код>
				<Наименование>Справочник: Магазины</Наименование>
				<Порядок>150</Порядок>
				<Источник>СправочникСсылка.Магазины</Источник>
				<Приемник>СправочникСсылка.Склады</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Значение = Источник.СкладПродажи.Код;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>6</Код>
						<Наименование>--&gt; ЭтоГруппа</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<ПередВыгрузкой>Значение = Ложь;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>4</Код>
						<Наименование>--&gt; ВидСклада</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидСклада" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыСкладов"/>
						<ПередВыгрузкой>Если Источник.СкладУправляющейСистемы Тогда
	Значение = "Оптовый";
Иначе
	Значение = "Розничный";
	//Значение = "НеавтоматизированнаяТорговаяТочка";
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ПравилоЦенообразования --&gt; ТипЦенРозничнойТорговли</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ПравилоЦенообразования" Вид="Реквизит" Тип="СправочникСсылка.ПравилаЦенообразования"/>
						<Приемник Имя="ТипЦенРозничнойТорговли" Вид="Реквизит" Тип="СправочникСсылка.ТипыЦенНоменклатуры"/>
						<КодПравилаКонвертации>ТипыЦенНоменклатуры                               </КодПравилаКонвертации>
						<ПередВыгрузкой>Если Источник.СкладУправляющейСистемы Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Склады</Код>
				<Наименование>Справочник: Склады</Наименование>
				<Порядок>200</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Склады</Источник>
				<Приемник>СправочникСсылка.Склады</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>5</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ТипыЦенНоменклатуры</Код>
				<Наименование>Справочник: Правила ценообразования</Наименование>
				<Порядок>250</Порядок>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>СправочникСсылка.ПравилаЦенообразования</Источник>
				<Приемник>СправочникСсылка.ТипыЦенНоменклатуры</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>1</Код>
						<Наименование>ЦенаВключаетНДС --&gt; ЦенаВключаетНДС</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ЦенаВключаетНДС" Вид="Реквизит" Тип="Булево"/>
						<Приемник Имя="ЦенаВключаетНДС" Вид="Реквизит" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Номенклатура</Код>
				<Наименование>Справочник: Номенклатура</Наименование>
				<Порядок>300</Порядок>
				<Источник>СправочникСсылка.Номенклатура</Источник>
				<Приемник>СправочникСсылка.Номенклатура</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Если Источник.ТипНоменклатуры = Перечисления.ТипыНоменклатуры.Услуга Тогда
	Значение = "Алкоголь (услуга)";
Иначе
	Значение = "Алкоголь";	
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>2</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<ПередВыгрузкой>Значение = Ложь;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ДоговорыКонтрагентов</Код>
				<Наименование>:</Наименование>
				<Порядок>350</Порядок>
				<ПередВыгрузкой>ТолькоПолучитьУзелСсылки = Ложь;</ПередВыгрузкой>
				<ПослеЗагрузки>Если (НЕ ОбъектНайден)
	ИЛИ НЕ ЗначениеЗаполнено(Объект.ВалютаВзаиморасчетов) Тогда
	Объект.ВалютаВзаиморасчетов = Параметры.ВалютаРегламентированногоУчета;
	Объект.НалоговыйАгентПоОплате = Ложь;
	Объект.РасчетыВУсловныхЕдиницах = Ложь;
	Объект.Наименование = Строка(Объект.ВидДоговора) + ", " + НРег(Объект.ВалютаВзаиморасчетов);
	Объект.ИспользуетсяПриОбменеДанными = Истина;
КонецЕсли;</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>Запрос = Новый Запрос("ВЫБРАТЬ
|	ДоговорыКонтрагентов.Ссылка
|ИЗ
|	Справочник.ДоговорыКонтрагентов КАК ДоговорыКонтрагентов
|ГДЕ
|	ДоговорыКонтрагентов.ВидДоговора = &amp;ВидДоговора
|	И ДоговорыКонтрагентов.Организация = &amp;Организация
|	И ДоговорыКонтрагентов.Владелец = &amp;Владелец
|	И ДоговорыКонтрагентов.ВалютаВзаиморасчетов = &amp;ВалютаВзаиморасчетов
|	И НЕ ДоговорыКонтрагентов.РасчетыВУсловныхЕдиницах
|	И НЕ ДоговорыКонтрагентов.ПометкаУдаления
|	И ДоговорыКонтрагентов.ЭтоГруппа = &amp;ЭтоГруппа");
Для Каждого СвойствоПоиска Из СвойстваПоиска Цикл 
	Запрос.УстановитьПараметр(СвойствоПоиска.Ключ, СвойствоПоиска.Значение);
КонецЦикла;
Запрос.УстановитьПараметр("ВалютаВзаиморасчетов", Параметры.ВалютаРегламентированногоУчета);
ВыборкаДоговоров = Запрос.Выполнить().Выбрать();
Если ВыборкаДоговоров.Следующий() Тогда
	СсылкаНаОбъект = ВыборкаДоговоров.Ссылка;
КонецЕсли;
ПрекратитьПоиск = Истина;</ПоследовательностьПолейПоиска>
				<Приемник>СправочникСсылка.ДоговорыКонтрагентов</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>--&gt; ВидДоговора</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидДоговора" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыДоговоровКонтрагентов"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>--&gt; Владелец</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Владелец" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>4</Код>
						<Наименование>--&gt; ЭтоГруппа</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<ПередВыгрузкой>Значение = Ложь;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ВидыОплатОрганизаций</Код>
				<Наименование>Справочник: Виды оплаты</Наименование>
				<Порядок>400</Порядок>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>СправочникСсылка.ВидыОплатЧекаККМ</Источник>
				<Приемник>СправочникСсылка.ВидыОплатОрганизаций</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Платежная карта";</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СтатьиДвиженияДенежныхСредств</Код>
				<Наименование>Справочник: Статьи движения денежных средств</Наименование>
				<Порядок>450</Порядок>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>СправочникСсылка.СтатьиДвиженияДенежныхСредств</Источник>
				<Приемник>СправочникСсылка.СтатьиДвиженияДенежныхСредств</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>5</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<КодПравилаКонвертации>СтатьиДвиженияДенежныхСредств                     </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СтатьиДвиженияДенежныхСредств_ПКО</Код>
				<Наименование>Справочник: Статьи движения денежных средств</Наименование>
				<Порядок>500</Порядок>
				<ПередВыгрузкой>КлючВыгружаемыхДанных = ВходящиеДанные.Магазин;</ПередВыгрузкой>
				<Источник>СправочникСсылка.СтатьиДвиженияДенежныхСредств</Источник>
				<Приемник>СправочникСсылка.СтатьиДвиженияДенежныхСредств</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Розничная выручка: "+ВходящиеДанные.Магазин;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Пользователи</Код>
				<Наименование>Справочник: Пользователи</Наименование>
				<Порядок>550</Порядок>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>СправочникСсылка.Пользователи</Источник>
				<Приемник>СправочникСсылка.Пользователи</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>ИдентификаторПользователяИБ --&gt; ИдентификаторПользователяИБ</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="ИдентификаторПользователяИБ" Вид="Реквизит" Тип="УникальныйИдентификатор"/>
						<Приемник Имя="ИдентификаторПользователяИБ" Вид="Реквизит" Тип="УникальныйИдентификатор"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ФизЛицо --&gt; ФизЛицо</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ФизЛицо" Вид="Реквизит" Тип="СправочникСсылка.ФизическиеЛица"/>
						<Приемник Имя="ФизЛицо" Вид="Реквизит" Тип="СправочникСсылка.ФизическиеЛица"/>
						<КодПравилаКонвертации>ФизическиеЛица                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>5</Код>
						<Наименование>--&gt; ЭтоГруппа</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>--&gt; Код</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ФизическиеЛица</Код>
				<Наименование>Справочник: Физические лица</Наименование>
				<Порядок>600</Порядок>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>СправочникСсылка.ФизическиеЛица</Источник>
				<Приемник>СправочникСсылка.ФизическиеЛица</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>ДатаРождения --&gt; ДатаРождения</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="ДатаРождения" Вид="Реквизит" Тип="Дата"/>
						<Приемник Имя="ДатаРождения" Вид="Реквизит" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Пол --&gt; Пол</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Пол" Вид="Реквизит" Тип="ПеречислениеСсылка.ПолФизическогоЛица"/>
						<Приемник Имя="Пол" Вид="Реквизит" Тип="ПеречислениеСсылка.ПолФизическихЛиц"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ФизическиеЛица"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ФизическиеЛица"/>
						<КодПравилаКонвертации>ФизическиеЛица                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>7</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>8</Код>
						<Наименование>--&gt; Код</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
		<Группа>
			<Код>Перечисления</Код>
			<Наименование>Перечисления</Наименование>
			<Порядок>150</Порядок>
			<Правило>
				<Код>СтавкиНДС</Код>
				<Наименование>Перечисление: Ставки НДС</Наименование>
				<Порядок>50</Порядок>
				<ПередВыгрузкой>Значение = "БезНДС";</ПередВыгрузкой>
				<Источник>ПеречислениеСсылка.СтавкиНДС</Источник>
				<Приемник>ПеречислениеСсылка.СтавкиНДС</Приемник>
				<Свойства/>
				<Значения>
					<Значение>
						<Код>1</Код>
						<Наименование>БезНДС --&gt; БезНДС</Наименование>
						<Порядок>50</Порядок>
						<Источник>БезНДС</Источник>
						<Приемник>БезНДС</Приемник>
					</Значение>
					<Значение>
						<Код>2</Код>
						<Наименование>НДС0 --&gt; НДС0</Наименование>
						<Порядок>100</Порядок>
						<Источник>НДС0</Источник>
						<Приемник>НДС0</Приемник>
					</Значение>
					<Значение>
						<Код>3</Код>
						<Наименование>НДС10 --&gt; НДС10</Наименование>
						<Порядок>150</Порядок>
						<Источник>НДС10</Источник>
						<Приемник>НДС10</Приемник>
					</Значение>
					<Значение>
						<Код>4</Код>
						<Наименование>НДС10_110 --&gt; НДС10_110</Наименование>
						<Порядок>200</Порядок>
						<Источник>НДС10_110</Источник>
						<Приемник>НДС10_110</Приемник>
					</Значение>
					<Значение>
						<Код>5</Код>
						<Наименование>НДС18 --&gt; НДС18</Наименование>
						<Порядок>250</Порядок>
						<Источник>НДС18</Источник>
						<Приемник>НДС18</Приемник>
					</Значение>
					<Значение>
						<Код>6</Код>
						<Наименование>НДС18_118 --&gt; НДС18_118</Наименование>
						<Порядок>300</Порядок>
						<Источник>НДС18_118</Источник>
						<Приемник>НДС18_118</Приемник>
					</Значение>
				</Значения>
			</Правило>
		</Группа>
	</ПравилаКонвертацииОбъектов>
	<ПравилаВыгрузкиДанных>
		<Группа Отключить="false">
			<Код>Документы</Код>
			<Наименование>Документы</Наименование>
			<Порядок>50</Порядок>
			<Правило Отключить="true">
				<Код>ПоступлениеТоваров</Код>
				<Наименование>Поступление товаров</Наименование>
				<Порядок>50</Порядок>
				<КодПравилаКонвертации>ПоступлениеТоваровУслуг                           </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ПоступлениеТоваров</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>Если ЗначениеЗаполнено(Параметры.Организация) Тогда
	
	Если ЗначениеЗаполнено(Объект.Организация.ГоловнаяОрганизация) Тогда
		Организация = Объект.Организация.ГоловнаяОрганизация;
	Иначе
		Организация = Объект.Организация;
	КонецЕсли;	
	
	Если НЕ Организация = Параметры.Организация Тогда
		Отказ = Истина;
	КонецЕсли;	
КонецЕсли;	
Если ЗначениеЗаполнено(Параметры.Магазин)
	И НЕ Объект.Магазин = Параметры.Магазин Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкойОбъекта>
			</Правило>
			<Правило Отключить="true">
				<Код>ОтчетОРозничныхПродажах</Код>
				<Наименование>Отчет о розничных продажах</Наименование>
				<Порядок>100</Порядок>
				<КодПравилаКонвертации>ОтчетОРозничныхПродажах                           </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОтчетОРозничныхПродажах</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>Отказ = Ложь;
Если ЗначениеЗаполнено(Параметры.Организация) Тогда
	
	Если ЗначениеЗаполнено(Объект.Организация.ГоловнаяОрганизация) Тогда
		Организация = Объект.Организация.ГоловнаяОрганизация;
	Иначе
		Организация = Объект.Организация;
	КонецЕсли;	
	
	Если НЕ Организация = Параметры.Организация Тогда
		Отказ = Истина;
	КонецЕсли;	
КонецЕсли;	

Если ЗначениеЗаполнено(Параметры.Магазин)
	И НЕ Объект.Магазин = Параметры.Магазин Тогда
	Отказ = Истина;
КонецЕсли;	

Если НЕ Отказ Тогда
	Запросы.ОперацияБух.УстановитьПараметр("Ссылка", Объект.Ссылка);
	РезультатыЗапроса = Запросы.ОперацияБух.Выполнить();
	ВыборкаРезультатЗапроса =  РезультатыЗапроса.Выбрать();
	Если ВыборкаРезультатЗапроса.Следующий() Тогда
		ВходящиеДанные = Новый Структура;
		ВыгрузитьПоПравилу(ВыборкаРезультатЗапроса, , , , "ОперацияБух");
	КонецЕсли;	
КонецЕсли;</ПередВыгрузкойОбъекта>
			</Правило>
			<Правило Отключить="true">
				<Код>ОприходованиеТоваров</Код>
				<Наименование>Оприходование товаров</Наименование>
				<Порядок>150</Порядок>
				<КодПравилаКонвертации>ОприходованиеТоваров                              </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОприходованиеТоваров</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>Если ЗначениеЗаполнено(Параметры.Организация) Тогда
	
	Если ЗначениеЗаполнено(Объект.Организация.ГоловнаяОрганизация) Тогда
		Организация = Объект.Организация.ГоловнаяОрганизация;
	Иначе
		Организация = Объект.Организация;
	КонецЕсли;	
	
	Если НЕ Организация = Параметры.Организация Тогда
		Отказ = Истина;
	КонецЕсли;	
КонецЕсли;	

Если ЗначениеЗаполнено(Параметры.Магазин)
	И НЕ Объект.Магазин = Параметры.Магазин Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкойОбъекта>
			</Правило>
			<Правило Отключить="true">
				<Код>СписаниеТоваров</Код>
				<Наименование>Списание товаров</Наименование>
				<Порядок>200</Порядок>
				<КодПравилаКонвертации>СписаниеТоваров                                   </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.СписаниеТоваров</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>Если ЗначениеЗаполнено(Параметры.Организация) Тогда
	
	Если ЗначениеЗаполнено(Объект.Организация.ГоловнаяОрганизация) Тогда
		Организация = Объект.Организация.ГоловнаяОрганизация;
	Иначе
		Организация = Объект.Организация;
	КонецЕсли;	
	
	Если НЕ Организация = Параметры.Организация Тогда
		Отказ = Истина;
	КонецЕсли;	
КонецЕсли;	
Если ЗначениеЗаполнено(Параметры.Магазин)
	И НЕ Объект.Магазин = Параметры.Магазин Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкойОбъекта>
			</Правило>
			<Правило Отключить="true">
				<Код>ПеремещениеТоваров</Код>
				<Наименование>Перемещение товаров</Наименование>
				<Порядок>250</Порядок>
				<КодПравилаКонвертации>ПеремещениеТоваров                                </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ПеремещениеТоваров</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>Если ЗначениеЗаполнено(Параметры.Организация) Тогда
	
	Если ЗначениеЗаполнено(Объект.Организация.ГоловнаяОрганизация) Тогда
		Организация = Объект.Организация.ГоловнаяОрганизация;
	Иначе
		Организация = Объект.Организация;
	КонецЕсли;	
	
	Если НЕ Организация = Параметры.Организация Тогда
		Отказ = Истина;
	КонецЕсли;	
КонецЕсли;	
Если ЗначениеЗаполнено(Параметры.Магазин)
	И НЕ (Объект.МагазинОтправитель = Параметры.Магазин 
	ИЛИ Объект.МагазинПолучатель = Параметры.Магазин) Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкойОбъекта>
			</Правило>
			<Правило Отключить="true">
				<Код>ВозвратТоваровПоставщику</Код>
				<Наименование>ВозвратТоваровПоставщику</Наименование>
				<Порядок>300</Порядок>
				<КодПравилаКонвертации>ВозвратТоваровПоставщику                          </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ВозвратТоваровПоставщику</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>Если ЗначениеЗаполнено(Параметры.Организация) Тогда
	
	Если ЗначениеЗаполнено(Объект.Организация.ГоловнаяОрганизация) Тогда
		Организация = Объект.Организация.ГоловнаяОрганизация;
	Иначе
		Организация = Объект.Организация;
	КонецЕсли;	
	
	Если НЕ Организация = Параметры.Организация Тогда
		Отказ = Истина;
	КонецЕсли;	
КонецЕсли;	
Если ЗначениеЗаполнено(Параметры.Магазин)
	И НЕ Объект.Магазин = Параметры.Магазин Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкойОбъекта>
			</Правило>
			<Группа Отключить="false">
				<Код>БанкКасса</Код>
				<Наименование>Касса и банк</Наименование>
				<Порядок>350</Порядок>
				<Правило Отключить="true">
					<Код>ПриходныйКассовыйОрдер</Код>
					<Наименование>Приходный кассовый ордер</Наименование>
					<Порядок>150</Порядок>
					<КодПравилаКонвертации>ПриходныйКассовыйОрдер                            </КодПравилаКонвертации>
					<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
					<ОбъектВыборки>ДокументСсылка.ПриходныйКассовыйОрдер</ОбъектВыборки>
					<ПередВыгрузкойОбъекта>Если ЗначениеЗаполнено(Параметры.Организация) Тогда
	
	Если ЗначениеЗаполнено(Объект.Организация.ГоловнаяОрганизация) Тогда
		Организация = Объект.Организация.ГоловнаяОрганизация;
	Иначе
		Организация = Объект.Организация;
	КонецЕсли;	
	
	Если НЕ Организация = Параметры.Организация Тогда
		Отказ = Истина;
	КонецЕсли;	
КонецЕсли;</ПередВыгрузкойОбъекта>
				</Правило>
			</Группа>
		</Группа>
	</ПравилаВыгрузкиДанных>
	<ПравилаОчисткиДанных/>
	<Алгоритмы>
		<Алгоритм Имя="ЗаполнитьВалютуДокумента" ИспользуетсяПриЗагрузке="true">
			<Текст>Объект.ВалютаДокумента  = Параметры.ВалютаРегламентированногоУчета;
Если ЗначениеЗаполнено(Объект.ДоговорКонтрагента) Тогда
	СтруктураКурсаДокумента = МодульВалютногоУчета.ПолучитьКурсВалюты(Объект.ДоговорКонтрагента.ВалютаВзаиморасчетов, Объект.Дата);
	Объект.КурсВзаиморасчетов      = СтруктураКурсаДокумента.Курс;
	Объект.КратностьВзаиморасчетов = СтруктураКурсаДокумента.Кратность;
КонецЕсли;</Текст>
		</Алгоритм>
		<Алгоритм Имя="ОбработатьЗаписьДокументаПослеЗагрузки" ИспользуетсяПриЗагрузке="true">
			<Текст>ПроведенОбъект = Объект.Проведен;
ПроведенСсылка = ОбщегоНазначения.ПолучитьЗначениеРеквизита(Объект.Ссылка, "Проведен");
ПроведенСсылка = ?(ПроведенСсылка = Неопределено, Ложь, ПроведенСсылка);


//Если Объект.ЭтоНовый() Тогда
//	Объект.Комментарий = "#Загружен новый документ";
//Иначе
//	Если ПроведенОбъект = ПроведенСсылка Тогда
//		Объект.Комментарий = "#Изменен документ";
//	ИначеЕсли ПроведенСсылка Тогда
//		Объект.Комментарий = "#Отменено проведение документа";
//	Иначе
//		Объект.Комментарий = "#Проведен документ";
//	КонецЕсли;
//КонецЕсли;</Текст>
		</Алгоритм>
		<Алгоритм Имя="ПередВыгрузкойПКС_ПолучитьУИД" ИспользуетсяПриЗагрузке="false">
			<Текст>Значение = Строка(Источник.УникальныйИдентификатор());</Текст>
		</Алгоритм>
		<Алгоритм Имя="ПередЗагрузкойДокумента_РежимЗаписи" ИспользуетсяПриЗагрузке="true">
			<Текст>//РежимЗаписи = "ОтменаПроведения";
РежимПроведения = "Неоперативный";</Текст>
		</Алгоритм>
		<Алгоритм Имя="ПолучитьПодразделение" ИспользуетсяПриЗагрузке="true">
			<Текст>Запрос = Новый Запрос;
Запрос.Параметры.Вставить("Ссылка", Склад);
Запрос.Текст = 
	
"ВЫБРАТЬ РАЗРЕШЕННЫЕ
|	Склады.ПодразделениеОрганизации,
|	Склады.ПодразделениеОрганизации.Владелец КАК ПодразделениеОрганизацииВладелец
|ИЗ
|	Справочник.Склады КАК Склады
|ГДЕ
|	Склады.Ссылка = &amp;Ссылка";
 
Результат = Запрос.Выполнить().Выбрать();
Результат.Следующий();
	 
ПодразделениеОрганизации = Результат.ПодразделениеОрганизации;
ПодразделениеОрганизацииВладелец = Результат.ПодразделениеОрганизацииВладелец;

Если ПодразделениеОрганизацииВладелец = Объект.Организация Тогда
	Подразделение = ПодразделениеОрганизации;
Иначе
	Подразделение = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
КонецЕсли;</Текст>
			<Параметры>Склад, Подразделение</Параметры>
		</Алгоритм>
		<Алгоритм Имя="ПослеЗагрузкиДокумента_УстановитьССылку" ИспользуетсяПриЗагрузке="true">
			<Текст>Если НЕ ОбъектНайден Тогда
	ИмяМенеджера = Объект.Метаданные().Имя;
	СтрокаУИД = ПараметрыОбъекта["УИД"];         
//	Сообщить("СтрокаУИД:"+СтрокаУИД);
	УИД = Новый УникальныйИдентификатор(СтрокаУИД);
	ССылкаДокумента = Документы[ИмяМенеджера].ПолучитьССылку(УИД);
	Объект.УстановитьССылкуНового(ССылкаДокумента);
Иначе
	ССылкаДокумента = Объект.Ссылка;
КонецЕсли;

НоваяСтрока =  Параметры.ТаблицаДокументов.Добавить();
НоваяСтрока.Ссылка 			= ССылкаДокумента;
НоваяСтрока.Номер 			= Объект.Номер;
НоваяСтрока.Дата 			= Объект.Дата;
НоваяСтрока.МетаданныеИмя 	= Объект.Метаданные().Имя;

Если ПараметрыОбъекта["Проведен"] Тогда
    НоваяСтрока.Действие = "Проведение";
ИначеЕсли ПараметрыОбъекта["ПометкаУдаления"] Тогда	
    НоваяСтрока.Действие = "Удаление";
КонецЕсли;</Текст>
		</Алгоритм>
	</Алгоритмы>
	<Запросы>
		<Запрос Имя="ОперацияБух" ИспользуетсяПриЗагрузке="false">
			<Текст>ВЫБРАТЬ
	ОтчетОРозничныхПродажах.Ссылка,
	ОтчетОРозничныхПродажах.Магазин,
	ОтчетОРозничныхПродажах.Организация,
	ОтчетОРозничныхПродажах.Номер,
	ОтчетОРозничныхПродажах.Дата,
	СУММА(ОтчетОРозничныхПродажахОплатаПлатежнымиКартами.Сумма) КАК СуммаОперации,
	Подстрока(ОтчетОРозничныхПродажах.Комментарий,1,100) КАК Комментарий,
	ОтчетОРозничныхПродажах.Проведен,
	ОтчетОРозничныхПродажах.ПометкаУдаления
ИЗ
	Документ.ОтчетОРозничныхПродажах.ОплатаПлатежнымиКартами КАК ОтчетОРозничныхПродажахОплатаПлатежнымиКартами
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетОРозничныхПродажах КАК ОтчетОРозничныхПродажах
		ПО ОтчетОРозничныхПродажахОплатаПлатежнымиКартами.Ссылка = ОтчетОРозничныхПродажах.Ссылка
ГДЕ
	ОтчетОРозничныхПродажах.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ОтчетОРозничныхПродажах.Ссылка,
	ОтчетОРозничныхПродажах.Магазин,
	ОтчетОРозничныхПродажах.Организация,
	ОтчетОРозничныхПродажах.Номер,
	ОтчетОРозничныхПродажах.Дата,
	Подстрока(ОтчетОРозничныхПродажах.Комментарий,1,100),
	ОтчетОРозничныхПродажах.Проведен,
	ОтчетОРозничныхПродажах.ПометкаУдаления</Текст>
		</Запрос>
		<Запрос Имя="ОприходованиеТоваров" ИспользуетсяПриЗагрузке="false">
			<Текст>ВЫБРАТЬ
	ОприходованиеТоваровТовары.Номенклатура,
	СУММА(ОприходованиеТоваровТовары.Количество) КАК Количество,
	ОприходованиеТоваровТовары.Цена,
	СУММА(ОприходованиеТоваровТовары.Сумма) КАК Сумма
ПОМЕСТИТЬ ВТ_ТабличнаяЧасть
ИЗ
	Документ.ОприходованиеТоваров.Товары КАК ОприходованиеТоваровТовары
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОприходованиеТоваров КАК ОприходованиеТоваров
		ПО ОприходованиеТоваровТовары.Ссылка = ОприходованиеТоваров.Ссылка
ГДЕ
	ОприходованиеТоваров.Ссылка = &amp;Ссылка
	И ОприходованиеТоваровТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар)

СГРУППИРОВАТЬ ПО
	ОприходованиеТоваровТовары.Номенклатура,
	ОприходованиеТоваровТовары.Цена
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ТабличнаяЧасть.Номенклатура,
	ВТ_ТабличнаяЧасть.Количество,
	ВТ_ТабличнаяЧасть.Сумма КАК Сумма,
	ВТ_ТабличнаяЧасть.Цена КАК Цена,
	ВТ_ТабличнаяЧасть.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения
ИЗ
	ВТ_ТабличнаяЧасть КАК ВТ_ТабличнаяЧасть</Текст>
		</Запрос>
		<Запрос Имя="ОтчетОРозничныхПродажахПоСебестоимости" ИспользуетсяПриЗагрузке="false">
			<Текст>ВЫБРАТЬ
	ВложенныйЗапрос.Номенклатура КАК Номенклатура,
	ВложенныйЗапрос.Цена КАК Цена,
	ВложенныйЗапрос.СтавкаНДС КАК СтавкаНДС,
	СУММА(ВложенныйЗапрос.Количество) КАК Количество,
	СУММА(ВложенныйЗапрос.Сумма) КАК Сумма,
	СУММА(ВложенныйЗапрос.СуммаНДС) КАК СуммаНДС
ПОМЕСТИТЬ ВТ_ТабличнаяЧасть
ИЗ
	(ВЫБРАТЬ
		ОтчетОРозничныхПродажахТовары.Номенклатура КАК Номенклатура,
		ОтчетОРозничныхПродажахТовары.Цена КАК Цена,
		ОтчетОРозничныхПродажахТовары.СтавкаНДС КАК СтавкаНДС,
		СУММА(ОтчетОРозничныхПродажахТовары.Количество) КАК Количество,
		СУММА(ОтчетОРозничныхПродажахТовары.Сумма) КАК Сумма,
		СУММА(ОтчетОРозничныхПродажахТовары.СуммаНДС) КАК СуммаНДС
	ИЗ
		Документ.ОтчетОРозничныхПродажах.Товары КАК ОтчетОРозничныхПродажахТовары
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетОРозничныхПродажах КАК ОтчетОРозничныхПродажах
			ПО ОтчетОРозничныхПродажахТовары.Ссылка = ОтчетОРозничныхПродажах.Ссылка
	ГДЕ
		ОтчетОРозничныхПродажах.Ссылка = &amp;Ссылка
	
	СГРУППИРОВАТЬ ПО
		ОтчетОРозничныхПродажахТовары.Номенклатура,
		ОтчетОРозничныхПродажахТовары.СтавкаНДС,
		ОтчетОРозничныхПродажахТовары.Цена
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ОтчетОРозничныхПродажахВозвращенныеТовары.Номенклатура,
		ОтчетОРозничныхПродажахВозвращенныеТовары.Цена,
		ОтчетОРозничныхПродажахВозвращенныеТовары.СтавкаНДС,
		СУММА(-ОтчетОРозничныхПродажахВозвращенныеТовары.Количество),
		СУММА(-ОтчетОРозничныхПродажахВозвращенныеТовары.Сумма),
		СУММА(-ОтчетОРозничныхПродажахВозвращенныеТовары.СуммаНДС)
	ИЗ
		Документ.ОтчетОРозничныхПродажах.ВозвращенныеТовары КАК ОтчетОРозничныхПродажахВозвращенныеТовары
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетОРозничныхПродажах КАК ОтчетОРозничныхПродажах
			ПО ОтчетОРозничныхПродажахВозвращенныеТовары.Ссылка = ОтчетОРозничныхПродажах.Ссылка
	ГДЕ
		ОтчетОРозничныхПродажах.Ссылка = &amp;Ссылка
	
	СГРУППИРОВАТЬ ПО
		ОтчетОРозничныхПродажахВозвращенныеТовары.Номенклатура,
		ОтчетОРозничныхПродажахВозвращенныеТовары.СтавкаНДС,
		ОтчетОРозничныхПродажахВозвращенныеТовары.Цена) КАК ВложенныйЗапрос

СГРУППИРОВАТЬ ПО
	ВложенныйЗапрос.Номенклатура,
	ВложенныйЗапрос.Цена,
	ВложенныйЗапрос.СтавкаНДС
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ТабличнаяЧасть.Номенклатура КАК Номенклатура,
	ВТ_ТабличнаяЧасть.Количество КАК Количество,
	ВТ_ТабличнаяЧасть.Сумма КАК Сумма,
	ВТ_ТабличнаяЧасть.СтавкаНДС КАК СтавкаНДС,
	ВТ_ТабличнаяЧасть.СуммаНДС КАК СуммаНДС,
	СебестоимостьНоменклатурыСрезПоследних.Цена * ВТ_ТабличнаяЧасть.Количество КАК Себестоимость,
	ВТ_ТабличнаяЧасть.Цена КАК Цена
ИЗ
	ВТ_ТабличнаяЧасть КАК ВТ_ТабличнаяЧасть
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СебестоимостьНоменклатуры.СрезПоследних(&amp;Период, Магазин = &amp;Магазин) КАК СебестоимостьНоменклатурыСрезПоследних
		ПО ВТ_ТабличнаяЧасть.Номенклатура = СебестоимостьНоменклатурыСрезПоследних.Номенклатура</Текст>
		</Запрос>
		<Запрос Имя="ПеремещениеТоваров" ИспользуетсяПриЗагрузке="false">
			<Текст>ВЫБРАТЬ
	ПеремещениеТоваровТовары.Номенклатура,
	СУММА(ПеремещениеТоваровТовары.Количество) КАК Количество,
	ПеремещениеТоваровТовары.Цена,
	СУММА(ПеремещениеТоваровТовары.Сумма) КАК Сумма
ПОМЕСТИТЬ ВТ_ТабличнаяЧасть
ИЗ
	Документ.ПеремещениеТоваров.Товары КАК ПеремещениеТоваровТовары
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПеремещениеТоваров КАК ПеремещениеТоваров
		ПО ПеремещениеТоваровТовары.Ссылка = ПеремещениеТоваров.Ссылка
ГДЕ
	ПеремещениеТоваров.Ссылка = &amp;Ссылка
	И ПеремещениеТоваровТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар)

СГРУППИРОВАТЬ ПО
	ПеремещениеТоваровТовары.Номенклатура,
	ПеремещениеТоваровТовары.Цена
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ТабличнаяЧасть.Номенклатура,
	ВТ_ТабличнаяЧасть.Количество,
	СебестоимостьНоменклатурыСрезПоследних.Цена * ВТ_ТабличнаяЧасть.Количество КАК Себестоимость,
	СебестоимостьНоменклатурыСрезПоследних.Цена * ВТ_ТабличнаяЧасть.Количество КАК Сумма,
	СебестоимостьНоменклатурыСрезПоследних.Цена КАК Цена,
	ВТ_ТабличнаяЧасть.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения
ИЗ
	ВТ_ТабличнаяЧасть КАК ВТ_ТабличнаяЧасть
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СебестоимостьНоменклатуры.СрезПоследних(&amp;Период, Магазин = &amp;Магазин) КАК СебестоимостьНоменклатурыСрезПоследних
		ПО ВТ_ТабличнаяЧасть.Номенклатура = СебестоимостьНоменклатурыСрезПоследних.Номенклатура</Текст>
		</Запрос>
		<Запрос Имя="ПоступлениеТоваровПоСебестоимости" ИспользуетсяПриЗагрузке="false">
			<Текст>ВЫБРАТЬ
	ПоступлениеТоваровТовары.Номенклатура,
	СУММА(ПоступлениеТоваровТовары.Количество) КАК Количество,
	ПоступлениеТоваровТовары.Цена,
	СУММА(ПоступлениеТоваровТовары.Сумма) КАК Сумма,
	ПоступлениеТоваровТовары.СтавкаНДС,
	СУММА(ПоступлениеТоваровТовары.СуммаНДС) КАК СуммаНДС
ПОМЕСТИТЬ ВТ_ТабличнаяЧасть
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваров КАК ПоступлениеТоваров
		ПО ПоступлениеТоваровТовары.Ссылка = ПоступлениеТоваров.Ссылка
ГДЕ
	ПоступлениеТоваров.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ПоступлениеТоваровТовары.Номенклатура,
	ПоступлениеТоваровТовары.СтавкаНДС,
	ПоступлениеТоваровТовары.Цена
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ТабличнаяЧасть.Номенклатура,
	СУММА(ВТ_ТабличнаяЧасть.Количество) КАК Количество,
	СУММА(ВТ_ТабличнаяЧасть.Сумма) КАК Сумма,
	ВТ_ТабличнаяЧасть.СтавкаНДС,
	СУММА(0) КАК СуммаНДС,
	ВТ_ТабличнаяЧасть.Цена КАК Цена
ИЗ
	ВТ_ТабличнаяЧасть КАК ВТ_ТабличнаяЧасть

СГРУППИРОВАТЬ ПО
	ВТ_ТабличнаяЧасть.Номенклатура,
	ВТ_ТабличнаяЧасть.СтавкаНДС,
	ВТ_ТабличнаяЧасть.Цена</Текст>
		</Запрос>
		<Запрос Имя="СписаниеТоваров" ИспользуетсяПриЗагрузке="false">
			<Текст>ВЫБРАТЬ
	СписаниеТоваровТовары.Номенклатура,
	СУММА(СписаниеТоваровТовары.Количество) КАК Количество,
	СписаниеТоваровТовары.Цена,
	СУММА(СписаниеТоваровТовары.Сумма) КАК Сумма
ПОМЕСТИТЬ ВТ_ТабличнаяЧасть
ИЗ
	Документ.СписаниеТоваров.Товары КАК СписаниеТоваровТовары
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СписаниеТоваров КАК СписаниеТоваров
		ПО СписаниеТоваровТовары.Ссылка = СписаниеТоваров.Ссылка
ГДЕ
	СписаниеТоваров.Ссылка = &amp;Ссылка
	И СписаниеТоваровТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар)

СГРУППИРОВАТЬ ПО
	СписаниеТоваровТовары.Номенклатура,
	СписаниеТоваровТовары.Цена
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ТабличнаяЧасть.Номенклатура,
	ВТ_ТабличнаяЧасть.Количество,
	ВТ_ТабличнаяЧасть.Сумма КАК Себестоимость,
	ВТ_ТабличнаяЧасть.Сумма КАК Сумма,
	ВТ_ТабличнаяЧасть.Цена КАК Цена,
	ВТ_ТабличнаяЧасть.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения
ИЗ
	ВТ_ТабличнаяЧасть КАК ВТ_ТабличнаяЧасть</Текст>
		</Запрос>
	</Запросы>
</ПравилаОбмена>